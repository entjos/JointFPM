<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fits a joint flexible parametric survival model (FPM) for a recurrent and
terminal event. The joint model can be used to predict the mean number of
events at different time points. This function is a wrapper around
rstpm2::stpm2()."><title>Joint FPMs for recurrent and competing events. — JointFPM • JointFPM</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Joint FPMs for recurrent and competing events. — JointFPM"><meta property="og:description" content="Fits a joint flexible parametric survival model (FPM) for a recurrent and
terminal event. The joint model can be used to predict the mean number of
events at different time points. This function is a wrapper around
rstpm2::stpm2()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">JointFPM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/entjos/JointFPM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Joint FPMs for recurrent and competing events.</h1>
      <small class="dont-index">Source: <a href="https://github.com/entjos/JointFPM/blob/HEAD/R/JointFPM.R" class="external-link"><code>R/JointFPM.R</code></a></small>
      <div class="d-none name"><code>JointFPM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a joint flexible parametric survival model (FPM) for a recurrent and
terminal event. The joint model can be used to predict the mean number of
events at different time points. This function is a wrapper around
<code><a href="https://rdrr.io/pkg/rstpm2/man/gsm.html" class="external-link">rstpm2::stpm2()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">JointFPM</span><span class="op">(</span></span>
<span>  <span class="va">surv</span>,</span>
<span>  <span class="va">re_model</span>,</span>
<span>  <span class="va">ce_model</span>,</span>
<span>  <span class="va">re_indicator</span>,</span>
<span>  <span class="va">ce_indicator</span>,</span>
<span>  df_ce <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  df_re <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  tvc_re_terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tvc_ce_terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">cluster</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>surv</dt>
<dd><p>A formula of the following form <code>Surv(...) ~ 1</code>.
The <code>Surv</code> objects needs to be of <code>type ==  'counting'</code> with the
following arguments:</p><dl><dt><code>time</code>: </dt>
<dd><p>Start of follow-up time for each event episode, i.e.,
usually 0 for the competing event and the first occurrence of the
recurrent event. For every subsequent event the follow-up can either
be 0 if gap time is the underlying time scale or the time of the
previous event if total time is the underlying time scale.</p></dd>

<dt><code>time2</code>: </dt>
<dd><p>End of follow-up, i.e., either occurrence of a terminal
or recurrent event, or time of censoring.</p></dd>

<dt><code>status</code>: </dt>
<dd><p>Event indicator for both terminal and recurrent
event.</p></dd>

<dt><code>type</code>: </dt>
<dd><p>Has to be <code>counting</code>.</p></dd>


</dl></dd>


<dt>re_model</dt>
<dd><p>A formula object specifying the model for the recurrent event
with an empty right hand side of the formula, e.g. <code>~ sex</code>.</p></dd>


<dt>ce_model</dt>
<dd><p>A formula object specifying the model for the competing event
with an empty right hand side of the formula, e.g. <code>~ sex</code>.</p></dd>


<dt>re_indicator</dt>
<dd><p>Indicator that defines which rows in the dataset belong to the recurrent
event process. These are usually more than one row per observations.
The variable name needs to be passed as a character vector.</p></dd>


<dt>ce_indicator</dt>
<dd><p>Indicator that defines which row in the dataset belong to the competing
event process. The variable name needs to be passed as a character vector.</p></dd>


<dt>df_ce</dt>
<dd><p>Defines the number of knots used to model the baseline hazard function
for the competing event process.</p></dd>


<dt>df_re</dt>
<dd><p>Defines the number of knots used to model the baseline hazard function
for the recurrent event process.</p></dd>


<dt>tvc_re_terms</dt>
<dd><p>A named list defining the number of knots used to model potential
time-varying effects of variables included in the recurrent event model.
This list should be of form <code>list(&lt;var_name&gt; = &lt;no. of knots&gt;)</code>.</p></dd>


<dt>tvc_ce_terms</dt>
<dd><p>A named list defining the number of knots used to model potential
time-varying effects of variables included in the competing event model.
This list should be of form <code>list(&lt;var_name&gt; = &lt;no. of knots&gt;)</code>.</p></dd>


<dt>cluster</dt>
<dd><p>A character vector specifying the name of the variable that defines unique
observations in the dataset passed to the function.</p></dd>


<dt>data</dt>
<dd><p>A stacked dataset that includes both data on the recurrent and competing
event process. The dataset should have one row for each observation
including the follow-up time and event indicator for the competing event
and possibly multiple rows for each observation including the follow-up
times and event indicator for the recurrent event, e.g.:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>id st_start  st_end re status</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a> <span class="dv">1</span>      <span class="dv">0</span>      <span class="fl">6.88</span>  <span class="dv">0</span>      <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a> <span class="dv">1</span>      <span class="dv">0</span>      <span class="fl">6.88</span>  <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a> <span class="dv">2</span>      <span class="dv">0</span>      <span class="fl">8.70</span>  <span class="dv">0</span>      <span class="dv">1</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a> <span class="dv">2</span>      <span class="dv">0</span>      <span class="fl">8.70</span>  <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a> <span class="dv">3</span>      <span class="dv">0</span>     <span class="dv">10</span>     <span class="dv">0</span>      <span class="dv">0</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a> <span class="dv">3</span>      <span class="dv">0</span>      <span class="fl">1.78</span>  <span class="dv">1</span>      <span class="dv">1</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a> <span class="dv">3</span>      <span class="fl">1.78</span>   <span class="fl">6.08</span>  <span class="dv">1</span>      <span class="dv">1</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a> <span class="dv">3</span>      <span class="fl">6.08</span>  <span class="dv">10</span>     <span class="dv">1</span>      <span class="dv">0</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a> <span class="dv">4</span>      <span class="dv">0</span>      <span class="fl">6.07</span>  <span class="dv">0</span>      <span class="dv">1</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a> <span class="dv">4</span>      <span class="dv">0</span>      <span class="fl">6.07</span>  <span class="dv">1</span>      <span class="dv">0</span></span></code></pre><p></p></div></dd>


<dt>control</dt>
<dd><p>List of arguments passed to <a href="https://rdrr.io/pkg/rstpm2/man/gsm.control.html" class="external-link">rstpm2::gsm.control</a>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to <a href="https://rdrr.io/pkg/rstpm2/man/gsm.html" class="external-link">rstpm2::stpm2</a>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>JointFPM</code> with the following elements:</p><dl><dt><code>model</code>: </dt>
<dd><p>The fitted FPM object,</p></dd>

<dt><code>re_terms</code>: </dt>
<dd><p>The terms used to model the recurrent event model,</p></dd>

<dt><code>ce_terms</code>: </dt>
<dd><p>The terms used to model the competing event model,</p></dd>

<dt><code>re_indicator</code>: </dt>
<dd><p>The name of the indicator variable of the recurrent
event</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">JointFPM</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span>time  <span class="op">=</span> <span class="va">start</span>,</span></span>
<span class="r-in"><span>              time2 <span class="op">=</span> <span class="va">stop</span>,</span></span>
<span class="r-in"><span>              event <span class="op">=</span> <span class="va">event</span>,</span></span>
<span class="r-in"><span>              type  <span class="op">=</span> <span class="st">'counting'</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>         re_model <span class="op">=</span> <span class="op">~</span> <span class="va">pyridoxine</span> <span class="op">+</span> <span class="va">thiotepa</span>,</span></span>
<span class="r-in"><span>         ce_model <span class="op">=</span> <span class="op">~</span> <span class="va">pyridoxine</span> <span class="op">+</span> <span class="va">thiotepa</span>,</span></span>
<span class="r-in"><span>         re_indicator <span class="op">=</span> <span class="st">"re"</span>,</span></span>
<span class="r-in"><span>         ce_indicator <span class="op">=</span> <span class="st">"ce"</span>,</span></span>
<span class="r-in"><span>         df_ce <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>         df_re <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>         tvc_ce_terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pyridoxine <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                             thiotepa   <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         tvc_re_terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pyridoxine <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                             thiotepa   <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         cluster  <span class="op">=</span> <span class="st">"id"</span>,</span></span>
<span class="r-in"><span>         data     <span class="op">=</span> <span class="va">bladder1_stacked</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rstpm2::stpm2(formula = model_formula, data = data, df = df_ce, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     smooth.formula = bh_formula, tvc.formula = tvc_formula, cluster = data[[cluster]], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     robust = TRUE, control = control)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               ce                               re </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      -4.26119784                      -3.88216765 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    ce:pyridoxine                      ce:thiotepa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      -0.59655478                      -0.59900162 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    re:pyridoxine                      re:thiotepa </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       0.16089523                       0.87325227 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ce:nsx(log(stop), 3)1            ce:nsx(log(stop), 3)2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       2.00351423                       4.30723633 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ce:nsx(log(stop), 3)3            re:nsx(log(stop), 3)1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       2.72222971                       3.31873438 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            re:nsx(log(stop), 3)2            re:nsx(log(stop), 3)3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       7.52378236                       3.28524605 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ce:pyridoxine:nsx(log(stop), 2)1 ce:pyridoxine:nsx(log(stop), 2)2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       1.44889533                      -0.26834877 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ce:thiotepa:nsx(log(stop), 2)1   ce:thiotepa:nsx(log(stop), 2)2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       0.90885411                       1.05531401 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re:pyridoxine:nsx(log(stop), 2)1 re:pyridoxine:nsx(log(stop), 2)2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      -0.23787431                      -0.08296329 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   re:thiotepa:nsx(log(stop), 2)1   re:thiotepa:nsx(log(stop), 2)2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      -2.34781263                      -0.42711985 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: -913.15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $re_model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~pyridoxine + thiotepa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x559d67b0bcf0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ce_model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~pyridoxine + thiotepa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x559d67b0bcf0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $re_indicator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "re"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ce_indicator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ce"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cluster</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "id"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "JointFPM"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua P. Entrop.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

